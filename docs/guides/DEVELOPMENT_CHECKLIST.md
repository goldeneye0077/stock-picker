# å¼€å‘æµç¨‹æ£€æŸ¥æ¸…å•

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£æè¿°ä½¿ç”¨ OpenSpec è¿›è¡Œ API ä¼˜å…ˆå¼€å‘çš„å®Œæ•´æµç¨‹ã€‚æ‰€æœ‰ API å¼€å‘å¿…é¡»éµå¾ªæ­¤æµç¨‹ã€‚

## ğŸ”„ å¼€å‘æµç¨‹

### é˜¶æ®µ 1: API è®¾è®¡ï¼ˆå¿…é¡»å®Œæˆï¼‰

#### 1.1 è®¾è®¡ API ç«¯ç‚¹
- [ ] ç¼–è¾‘ `specs/openapi.yaml` æˆ– `specs/data-service-openapi.yaml`
- [ ] å®šä¹‰è·¯å¾„ã€æ–¹æ³•ã€å‚æ•°ã€å“åº”
- [ ] æ·»åŠ è¯¦ç»†çš„æè¿°å’Œç¤ºä¾‹

#### 1.2 éªŒè¯è§„èŒƒ
```bash
npm run specs:validate
```
- [ ] è§„èŒƒè¯­æ³•æ­£ç¡®
- [ ] æ‰€æœ‰å¼•ç”¨æœ‰æ•ˆ
- [ ] å“åº”çŠ¶æ€ç å®Œæ•´

#### 1.3 æ£€æŸ¥è§„èŒƒè´¨é‡
```bash
npm run specs:lint
```
- [ ] æ¯ä¸ªæ“ä½œæœ‰ summary å’Œ description
- [ ] æ¯ä¸ªå‚æ•°æœ‰ description
- [ ] é¿å…ä½¿ç”¨ any ç±»å‹
- [ ] æšä¸¾å€¼ä½¿ç”¨è›‡å½¢å‘½å

#### 1.4 é¢„è§ˆæ–‡æ¡£
```bash
npm run specs:preview
```
- [ ] åœ¨æµè§ˆå™¨ä¸­é¢„è§ˆ API æ–‡æ¡£
- [ ] ç¡®è®¤æ¥å£è®¾è®¡ç¬¦åˆéœ€æ±‚

### é˜¶æ®µ 2: ä»£ç ç”Ÿæˆ

#### 2.1 ç”Ÿæˆ TypeScript ç±»å‹
```bash
npm run specs:generate
```
- [ ] ç±»å‹æ–‡ä»¶ç”ŸæˆæˆåŠŸ: `frontend/src/types/api.generated.ts`
- [ ] æ— ç±»å‹ç”Ÿæˆé”™è¯¯

#### 2.2 æ›´æ–°å‰ç«¯ API å®¢æˆ·ç«¯
- [ ] å¯¼å…¥ç”Ÿæˆçš„ç±»å‹
- [ ] ä½¿ç”¨ç±»å‹å®‰å…¨çš„ API è°ƒç”¨
- [ ] æ›´æ–°ç›¸å…³ç»„ä»¶

### é˜¶æ®µ 3: åç«¯å®ç°

#### 3.1 å®ç°è·¯ç”±å¤„ç†å‡½æ•°
- [ ] åœ¨ `backend/src/routes/` æˆ– `data-service/src/routes/` ä¸­æ·»åŠ å®ç°
- [ ] éµå¾ªè§„èŒƒå®šä¹‰çš„è¯·æ±‚/å“åº”æ ¼å¼
- [ ] æ·»åŠ é”™è¯¯å¤„ç†

#### 3.2 éªŒè¯å®ç°
- [ ] ä½¿ç”¨ç”Ÿæˆçš„æ–‡æ¡£è¿›è¡Œæµ‹è¯•
- [ ] ç¡®è®¤å“åº”æ ¼å¼ç¬¦åˆè§„èŒƒ
- [ ] æµ‹è¯•è¾¹ç•Œæƒ…å†µå’Œé”™è¯¯åœºæ™¯

### é˜¶æ®µ 4: æµ‹è¯•éªŒè¯

#### 4.1 è¿è¡Œå¥‘çº¦æµ‹è¯•
```bash
npm run test:specs
```
- [ ] æ‰€æœ‰å¥‘çº¦æµ‹è¯•é€šè¿‡
- [ ] è§„èŒƒå®Œæ•´æ€§éªŒè¯é€šè¿‡

#### 4.2 é›†æˆæµ‹è¯•
- [ ] å‰ç«¯è°ƒç”¨åç«¯ API
- [ ] æ•°æ®æœåŠ¡è°ƒç”¨éªŒè¯
- [ ] ç«¯åˆ°ç«¯åŠŸèƒ½æµ‹è¯•

## ğŸš¨ æäº¤å‰æ£€æŸ¥

### ä»£ç æäº¤
```bash
git add .
git commit -m "feat: æ·»åŠ æ–°çš„APIç«¯ç‚¹"
```
- [ ] è‡ªåŠ¨è¿è¡Œ `npm run precommit`
- [ ] OpenAPI è§„èŒƒéªŒè¯é€šè¿‡
- [ ] è§„èŒƒè´¨é‡æ£€æŸ¥é€šè¿‡

### å¦‚æœéªŒè¯å¤±è´¥
1. ä¿®å¤è§„èŒƒæ–‡ä»¶ä¸­çš„é”™è¯¯
2. é‡æ–°è¿è¡ŒéªŒè¯
3. ç¡®è®¤æ‰€æœ‰æ£€æŸ¥é€šè¿‡åå†æäº¤

## ğŸ“ è§„èŒƒç¼–å†™æŒ‡å—

### è·¯å¾„å®šä¹‰æ¨¡æ¿
```yaml
paths:
  /api/resource/{id}:
    get:
      tags: [resource]
      summary: è·å–èµ„æºè¯¦æƒ…
      description: æ ¹æ®IDè·å–èµ„æºè¯¦ç»†ä¿¡æ¯
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            pattern: '^[a-f0-9]{24}$'
      responses:
        '200':
          description: æˆåŠŸè¿”å›èµ„æºè¯¦æƒ…
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResourceDetail'
        '404':
          description: èµ„æºä¸å­˜åœ¨
```

### ç»„ä»¶å®šä¹‰æ¨¡æ¿
```yaml
components:
  schemas:
    ResourceItem:
      type: object
      required: [id, name]
      properties:
        id:
          type: string
          description: èµ„æºID
        name:
          type: string
          description: èµ„æºåç§°
        created_at:
          type: string
          format: date-time
          description: åˆ›å»ºæ—¶é—´
```

### å®‰å…¨æ–¹æ¡ˆ
```yaml
securitySchemes:
  ApiKeyAuth:
    type: apiKey
    in: header
    name: X-API-Key
    description: APIå¯†é’¥è®¤è¯
```

## ğŸ”§ å·¥å…·ä½¿ç”¨

### å¸¸ç”¨å‘½ä»¤
| å‘½ä»¤ | ç”¨é€” | è¾“å‡º |
|------|------|------|
| `npm run specs:validate` | éªŒè¯è§„èŒƒè¯­æ³• | éªŒè¯ç»“æœ |
| `npm run specs:lint` | æ£€æŸ¥è§„èŒƒè´¨é‡ | è´¨é‡æŠ¥å‘Š |
| `npm run specs:generate` | ç”ŸæˆTypeScriptç±»å‹ | `api.generated.ts` |
| `npm run specs:docs` | ç”ŸæˆAPIæ–‡æ¡£ | `dist/docs.html` |
| `npm run specs:preview` | é¢„è§ˆAPIæ–‡æ¡£ | æœ¬åœ°æœåŠ¡å™¨ |
| `npm run test:specs` | è¿è¡Œå¥‘çº¦æµ‹è¯• | æµ‹è¯•æŠ¥å‘Š |

### é—®é¢˜æ’æŸ¥
1. **è§„èŒƒéªŒè¯å¤±è´¥**
   ```bash
   cd specs
   npm run validate -- --verbose
   ```

2. **ç±»å‹ç”Ÿæˆé”™è¯¯**
   ```bash
   cd specs
   npx openapi-typescript openapi.yaml --debug
   ```

3. **æ–‡æ¡£ç”Ÿæˆé—®é¢˜**
   ```bash
   rm -rf specs/dist
   npm run specs:docs
   ```

## ğŸ“ˆ æœ€ä½³å®è·µ

### è®¾è®¡åŸåˆ™
1. **ä¸€è‡´æ€§**: ä¿æŒç›¸ä¼¼çš„ç«¯ç‚¹ä½¿ç”¨ç›¸åŒçš„æ¨¡å¼
2. **å¯å‘ç°æ€§**: ä½¿ç”¨æ¸…æ™°çš„å‘½åå’Œåˆ†ç»„
3. **å¯æ‰©å±•æ€§**: è®¾è®¡æ—¶è€ƒè™‘æœªæ¥æ‰©å±•
4. **å‘åå…¼å®¹**: é¿å…ç ´åæ€§å˜æ›´

### ç‰ˆæœ¬æ§åˆ¶
1. **è§„èŒƒæ–‡ä»¶çº³å…¥ç‰ˆæœ¬æ§åˆ¶**
2. **æ¯æ¬¡å˜æ›´è®°å½•å˜æ›´æ—¥å¿—**
3. **ä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶APIç‰ˆæœ¬**

### å›¢é˜Ÿåä½œ
1. **è§„èŒƒè¯„å®¡ä½œä¸ºä»£ç è¯„å®¡çš„ä¸€éƒ¨åˆ†**
2. **ä½¿ç”¨åˆ†æ”¯è¿›è¡Œè§„èŒƒä¿®æ”¹**
3. **åˆå¹¶å‰å¿…é¡»é€šè¿‡æ‰€æœ‰æ£€æŸ¥**

## ğŸ¯ è´¨é‡æŒ‡æ ‡

### è§„èŒƒè´¨é‡
- [ ] æ‰€æœ‰æ“ä½œæœ‰å®Œæ•´çš„æ–‡æ¡£
- [ ] å‚æ•°æœ‰éªŒè¯è§„åˆ™
- [ ] å“åº”æœ‰æ˜ç¡®çš„schema
- [ ] é”™è¯¯å¤„ç†å®Œæ•´

### ä»£ç è´¨é‡
- [ ] ä½¿ç”¨ç”Ÿæˆçš„ç±»å‹
- [ ] ç±»å‹å®‰å…¨æ— any
- [ ] é”™è¯¯å¤„ç†å®Œå–„
- [ ] æµ‹è¯•è¦†ç›–å……åˆ†

### æµç¨‹è´¨é‡
- [ ] è®¾è®¡å…ˆè¡Œæµç¨‹éµå®ˆ
- [ ] æäº¤å‰æ£€æŸ¥é€šè¿‡
- [ ] æ–‡æ¡£ä¸å®ç°ä¸€è‡´
- [ ] å˜æ›´è®°å½•å®Œæ•´

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [OpenAPI 3.0 è§„èŒƒ](https://spec.openapis.org/oas/v3.0.3)
- [å¼€å‘æµç¨‹æŒ‡å—](specs/DEVELOPMENT_WORKFLOW.md)
- [API æ–‡æ¡£](specs/dist/index.html)
- [ç±»å‹å®šä¹‰](frontend/src/types/api.generated.ts)