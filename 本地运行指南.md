# 智能选股系统 - 本地运行指南

## 快速开始

### 方式一：使用一键启动脚本（推荐）

#### Windows 用户
1. 双击运行 `START_ALL_SERVICES.bat`
2. 等待服务启动完成
3. 自动打开浏览器访问 http://localhost:3001

#### Mac/Linux 用户
```bash
# 1. 进入项目目录
cd stock-picker

# 2. 运行启动脚本
chmod +x START_ALL_SERVICES.sh
./START_ALL_SERVICES.sh

# 3. 浏览器访问 http://localhost:3001
```

### 方式二：手动启动各个服务

#### 1. 安装依赖（首次运行）
```bash
# 安装 Node.js 依赖
npm install           # 根目录
cd backend && npm install && cd ..
cd frontend && npm install && cd ..

# 安装 Python 依赖
pip3 install -r data-service/requirements.txt
```

#### 2. 配置环境变量
```bash
# 复制环境变量模板
cp backend/.env.example backend/.env

# 创建数据服务环境变量文件
cat > data-service/.env << 'EOF'
DATABASE_PATH=../data/stock_picker.db
# TUSHARE_TOKEN=your_token_here  # 可选
EOF
```

#### 3. 启动服务（分别开 3 个终端）

**终端 1 - 后端服务**
```bash
cd backend
npm run dev
# 访问: http://localhost:3000
```

**终端 2 - 数据服务**
```bash
cd data-service
python3 -m uvicorn src.main:app --reload --port 8001
# 访问: http://localhost:8001
# API 文档: http://localhost:8001/docs
```

**终端 3 - 前端服务**
```bash
cd frontend
npm run dev
# 访问: http://localhost:3001
```

## 访问地址

| 服务 | 地址 | 说明 |
|------|------|------|
| 前端界面 | http://localhost:3001 | 主界面 |
| 后端API | http://localhost:3000 | REST API |
| 数据服务 | http://localhost:8001 | 数据处理服务 |
| API文档 | http://localhost:8001/docs | Swagger 文档 |

## 导入数据

### 方式一：创建示例数据（快速测试）
```bash
python create_sample_data.py
```

### 方式二：下载真实数据（需要 Tushare Token）
1. 注册 [Tushare Pro](https://tushare.pro/) 获取 Token
2. 在 `data-service/.env` 中配置：
   ```
   TUSHARE_TOKEN=你的token
   ```
3. 运行批量下载脚本：
   ```bash
   python download_7days_all_stocks.py
   ```

## 常见问题

### 1. 端口被占用
```bash
# 查看端口占用
# Mac/Linux
lsof -i :3000
lsof -i :3001
lsof -i :8001

# Windows
netstat -ano | findstr :3000
netstat -ano | findstr :3001
netstat -ano | findstr :8001

# 杀死占用端口的进程
kill -9 <PID>  # Mac/Linux
taskkill /PID <PID> /F  # Windows
```

### 2. 依赖安装失败
```bash
# 清理缓存重新安装
rm -rf node_modules package-lock.json
npm install

# Python 依赖问题
pip3 install --upgrade pip
pip3 install -r data-service/requirements.txt
```

### 3. 数据库文件不存在
数据库文件会在首次启动时自动创建在 `data/stock_picker.db`。
如果需要手动创建：
```bash
mkdir -p data
```

### 4. 前端页面空白
1. 检查浏览器控制台是否有错误
2. 确认后端服务已启动并可访问
3. 检查 `frontend/src/config/api.ts` 中的 API 地址配置

## 停止服务

### 使用启动脚本
- Windows: 关闭各个服务窗口
- Mac/Linux: 在启动脚本终端按 `Ctrl+C`

### 手动停止
在各个服务的终端按 `Ctrl+C`

## 系统要求

- Node.js >= 18.x
- Python >= 3.8
- npm >= 8.x
- 可用内存 >= 2GB
- 磁盘空间 >= 1GB

## 技术支持

详细文档请查看：
- 项目说明: `README.md`
- 开发指南: `CLAUDE.md`
- 数据采集: `批量数据采集使用说明.md`
